<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">



<mapper namespace="Trash-Mapper">

	<sql id="trType">
		<if test="trType == 'rma'.toString()">RECEIVEMAIL</if>
		<if test="trType == 'sma'.toString()">SENDMAIL</if>
		<if test="trType == 'tok'.toString()">TOTALKNOLEDGEBOARD</if>
		<if test="trType == 'koh'.toString()">KNOWHOWBOARD</if>
		<if test="trType == 'cpa'.toString()">COPARCHIVE</if>
		<if test="trType == 'pra'.toString()">PROJECTARCHIEVE</if>
		<if test="trType == 'prr'.toString()">PROJECTREPORTBOARD</if>
	</sql>

	<sql id="trCode">
		<if test="trType == 'rma'.toString()">RM</if>
		<if test="trType == 'sma'.toString()">SM</if>
		<if test="trType == 'tok'.toString()">TK</if>
		<if test="trType == 'cpa'.toString()">CA</if>
		<if test="trType == 'koh'.toString()">KH</if>
		<if test="trType == 'pra'.toString()">PA</if>
		<if test="trType == 'prr'.toString()">PR</if>
	</sql>





	<select id="selectTrashType" parameterType="str" resultType="str">
		select distinct TR_TYPE
		from trash
		where emp_id = #{empId}
	</select>

	<select id="selectTrashCntByTrType" parameterType="trash" resultType="int">
		select count(*)
		from trash
		where tr_type = #{trType}
		and emp_Id=#{empId}
	</select>




	<select id="selectTrashListByTrType" parameterType="trash" resultType="trash">
		select *
		from trash
		where TR_Type = #{trType}
		and emp_id = #{empId}
	</select>
	



	<update id="insertTrash" parameterType="trash">
		insert into 
		trash(TR_CODE,EMP_ID,CODE,TR_TYPE,TR_REGDATE, TR_TITLE)
		values(concat('t',TRASH_SEQ.NEXTVAL),#{empId},#{code},#{trType},sysdate, '<include refid="trType" />')
	
	</update>



	<!-- 휴지통에서 게시판으로 복원 -->
	<update id="restoreBoard" parameterType="trash">
		update 
		<include refid="trType" />
		set
		where <include refid="trCode" />_CODE = #{code}
	</update>
	
	<!-- 게시판에서 삭제 -->
	<update id="deleteBoard" parameterType="trash">
		delete from
		<include refid="trType" />
		where <include refid="trCode" />_CODE = #{code}
	</update>

	<!-- 휴지통에서 삭제 -->
	<update id="deleteTrash" parameterType="str">
		delete from trash
		where tr_code = #{trCode}
	</update>





</mapper>
















